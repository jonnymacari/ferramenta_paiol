{% extends 'base.html' %}
{% block title %}Dashboard do Gestor{% endblock %}

{% block content %}
<h2 class="mb-4">Ol√°, {{ user.first_name }}! üëã</h2>

<div class="row g-4 mb-4">
  <div class="col-md-4">
    <div class="card border-primary">
      <div class="card-body text-primary">
        <h5 class="card-title">Temporadas Criadas</h5>
        <p class="card-text display-6">{{ total_temporadas }}</p>
        <a href="{% url 'lista_temporadas' %}" class="btn btn-outline-primary">Ver Temporadas</a>
      </div>
    </div>
  </div>

  <div class="col-md-4">
    <div class="card border-warning">
      <div class="card-body text-warning">
        <h5 class="card-title">Interesses Pendentes</h5>
        <p class="card-text display-6">{{ interesses_pendentes }}</p>
        <a href="{% url 'lista_temporadas' %}" class="btn btn-outline-warning">Aprovar Monitores</a>
      </div>
    </div>
  </div>

  <div class="col-md-4">
    <div class="card border-info">
      <div class="card-body text-info">
        <h5 class="card-title">E-mails N√£o Enviados</h5>
        <p class="card-text display-6">{{ temporadas_sem_email }}</p>
        <a href="{% url 'lista_temporadas' %}" class="btn btn-outline-info">Enviar E-mails</a>
      </div>
    </div>
  </div>
</div>

<!-- Se√ß√£o de Informa√ß√µes dos Usu√°rios -->
<div class="row g-4 mb-4">
  <div class="col-12">
    <h3 class="mb-3">Informa√ß√µes dos Usu√°rios</h3>
  </div>
  
  <div class="col-md-3">
    <div class="card border-success">
      <div class="card-body text-success">
        <h5 class="card-title">Total de Usu√°rios</h5>
        <p class="card-text display-6">{{ total_usuarios }}</p>
      </div>
    </div>
  </div>

  <div class="col-md-3">
    <div class="card border-danger">
      <div class="card-body text-danger">
        <h5 class="card-title">Administradores</h5>
        <p class="card-text display-6">{{ usuarios_por_tipo.admin }}</p>
      </div>
    </div>
  </div>

  <div class="col-md-3">
    <div class="card border-primary">
      <div class="card-body text-primary">
        <h5 class="card-title">Gestores</h5>
        <p class="card-text display-6">{{ usuarios_por_tipo.gestor }}</p>
      </div>
    </div>
  </div>

  <div class="col-md-3">
    <div class="card border-secondary">
      <div class="card-body text-secondary">
        <h5 class="card-title">Monitores</h5>
        <p class="card-text display-6">{{ usuarios_por_tipo.monitor }}</p>
      </div>
    </div>
  </div>
</div>

<!-- Se√ß√£o de Gerenciamento -->
<div class="row g-4 mb-4">
  <div class="col-12">
    <h3 class="mb-3">Gerenciamento</h3>
  </div>
  
  <div class="col-md-3">
    <div class="card border-info">
      <div class="card-body text-center">
        <h6 class="card-title">Usu√°rios</h6>
        <p class="text-muted">Criar, editar e gerenciar usu√°rios</p>
        <a href="{% url 'manage_users' %}" class="btn btn-info">
          <i class="fas fa-users"></i> Gerenciar Usu√°rios
        </a>
      </div>
    </div>
  </div>

  <div class="col-md-3">
    <div class="card border-primary">
      <div class="card-body text-center">
        <h6 class="card-title">Temporadas</h6>
        <p class="text-muted">Visualizar e gerenciar temporadas</p>
        <a href="{% url 'lista_temporadas' %}" class="btn btn-primary">
          <i class="fas fa-calendar"></i> Ver Temporadas
        </a>
      </div>
    </div>
  </div>

  <div class="col-md-3">
    <div class="card border-warning">
      <div class="card-body text-center">
        <h6 class="card-title">Monitores</h6>
        <p class="text-muted">Aprovar participa√ß√µes de monitores</p>
        <a href="{% url 'approve_monitors' %}" class="btn btn-warning">
          <i class="fas fa-user-check"></i> Aprovar Monitores
        </a>
      </div>
    </div>
  </div>

  <div class="col-md-3">
    <div class="card border-success">
      <div class="card-body text-center">
        <h6 class="card-title">E-mails</h6>
        <p class="text-muted">Enviar comunica√ß√µes</p>
        <a href="{% url 'lista_temporadas' %}" class="btn btn-success">
          <i class="fas fa-envelope"></i> Enviar E-mails
        </a>
      </div>
    </div>
  </div>
</div>

<!-- √öltimos Usu√°rios Cadastrados -->
<div class="row g-4">
  <div class="col-12">
    <div class="card">
      <div class="card-header">
        <h5 class="mb-0">√öltimos Usu√°rios Cadastrados</h5>
      </div>
      <div class="card-body">
        {% if ultimos_usuarios %}
          <div class="table-responsive">
            <table class="table table-striped">
              <thead>
                <tr>
                  <th>Nome de Usu√°rio</th>
                  <th>Email</th>
                  <th>Tipo</th>
                  <th>Data de Cadastro</th>
                </tr>
              </thead>
              <tbody>
                {% for usuario in ultimos_usuarios %}
                <tr>
                  <td>{{ usuario.username }}</td>
                  <td>{{ usuario.email|default:"N√£o informado" }}</td>
                  <td>
                    <span class="badge 
                      {% if usuario.user_type == 'admin' %}bg-danger
                      {% elif usuario.user_type == 'gestor' %}bg-primary
                      {% else %}bg-secondary{% endif %}">
                      {{ usuario.get_user_type_display }}
                    </span>
                  </td>
                  <td>{{ usuario.date_joined|date:"d/m/Y H:i" }}</td>
                </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
        {% else %}
          <p class="text-muted">Nenhum usu√°rio cadastrado ainda.</p>
        {% endif %}
      </div>
    </div>
  </div>
</div>
{% endblock %}
